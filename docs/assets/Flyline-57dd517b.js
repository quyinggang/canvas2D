import{r as w,o as z,a as S,b as v,c as x}from"./index-9a21a5d4.js";const B={__name:"Flyline",setup(E){const l=w(null);return z(()=>{const g=l.value;let o=null;class m{constructor(t){this.domElement=document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.setCanvasSize(t),this.setCanvasAttrs(),this.ctx.scale(t.pixel,t.pixel)}setCanvasSize(t){const{width:e,height:s,pixel:i}=t;this.width=e*i,this.height=s*i,this.styleWidth=e,this.styleHeight=s}setCanvasAttrs(){const{width:t,height:e,styleWidth:s,styleHeight:i,domElement:n}=this;n.width=t,n.height=e,n.style.cssText=`width:${s}px;height:${i}px;`}}class b{constructor(t,e,s){this.start=t,this.end=e,this.color=s}render(t){const{start:e,end:s,color:i}=this;t.save(),t.lineWidth=3,t.lineCap="round",t.strokeStyle=i,t.shadowColor="rgba(255, 0, 255, 1)",t.shadowBlur=5,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(s.x,s.y),t.stroke(),t.closePath(),t.restore()}}class T{constructor(t,e){this.points=t,this.color=e}render(t){const{points:e,color:s}=this,[i,...n]=e;t.save(),t.lineCap="round",t.lineWidth=3,t.strokeStyle=s,t.beginPath(),t.moveTo(i.x,i.y);for(const h of n)t.lineTo(h.x,h.y);t.stroke(),t.closePath(),t.restore()}}class p{constructor(t){this.container=t.container;const e=this.container.getBoundingClientRect();this.canvas=new m({pixel:window.devicePixelRatio,width:e.width,height:e.height}),this.bounding=e,this.straightStartT=0,this.straightEndT=0,this.straightLine=this.getStraightPath(),this.bezierStartT=0,this.bezierEndT=0,this.bezierPath=this.getBezierPath(),this.mountCanvas()}mountCanvas(){this.container.appendChild(this.canvas.domElement)}createGradient(t,e){const i=this.canvas.ctx.createLinearGradient(t.x,t.y,e.x,e.y);return i.addColorStop(0,"rgba(255, 0, 255, 0)"),i.addColorStop(1,"rgba(255, 0, 255, 1)"),i}computeLinePoint(t,e,s){return{x:t.x+(e.x-t.x)*s,y:t.y+(e.y-t.y)*s}}getStraightPath(){const{width:t,height:e}=this.bounding,s=0,i={x:s,y:s},n={x:t-s,y:e/2};return{start:i,end:n}}renderStraightLine(){const{bounding:t,straightLine:e}=this,{start:s,end:i}=e,n=this.canvas.ctx;this.straightEndT<.1&&(this.straightStartT=0),n.clearRect(0,0,t.width,t.height);const h=this.computeLinePoint(s,i,this.straightStartT),r=this.computeLinePoint(s,i,this.straightEndT),c=this.createGradient(h,r);new b(h,r,c).render(n),this.straightStartT+=.005,this.straightEndT+=.005,this.straightStartT>1&&this.straightEndT>1&&(this.straightStartT=0,this.straightEndT=0),o=window.requestAnimationFrame(this.renderStraightLine.bind(this))}computeBezier2Point(t,e,s,i){return{x:(1-i)*(1-i)*t.x+2*i*(1-i)*s.x+i*i*e.x,y:(1-i)*(1-i)*t.y+2*i*(1-i)*s.y+i*i*e.y}}getBezierPath(){const{width:t,height:e}=this.bounding;return{start:{x:0,y:e/2},end:{x:t,y:e/2},control:{x:t/2,y:e/2-200}}}renderBezier(){const{bezierPath:t,bounding:e}=this,s=this.canvas.ctx,{start:i,end:n,control:h}=t,r=[];this.bezierEndT<.15&&(this.bezierStartT=0);const c=(this.bezierEndT-this.straightStartT)/20||.005;for(let d=this.bezierStartT;d<this.bezierEndT;d+=c){const y=this.computeBezier2Point(i,n,h,d);r.push(y)}r.push(this.computeBezier2Point(i,n,h,this.bezierEndT)),s.clearRect(0,0,e.width,e.height);const u=this.createGradient(r[0],r[r.length-1]);new T(r,u).render(s),this.bezierStartT+=.005,this.bezierEndT+=.005,this.bezierStartT>1&&this.bezierEndT>1&&(this.bezierStartT=0,this.bezierEndT=0),o=window.requestAnimationFrame(this.renderBezier.bind(this))}}new p({container:g}).renderStraightLine(),S(()=>window.cancelAnimationFrame(o))}),(g,o)=>(v(),x("div",{class:"box",ref_key:"boxElementRef",ref:l},null,512))}};export{B as default};
